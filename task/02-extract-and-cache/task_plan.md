# Task Plan: ETL Часть 1: Схема, Извлечение и Кэширование
**Номер:** 02
**Дата:** 2025-09-19
**Статус:** planned

**Контекст:** Мы подготовили рабочее окружение. Следующий шаг — загрузить в него данные. Эта задача закладывает основу для нашего ETL-пайплайна.

**Идея:** Создать первый, воспроизводимый этап ETL: определить схему данных в Neo4j, извлечь "сырые" данные из внешнего источника и сохранить их в локальный кэш. Этот кэш станет отправной точкой для последующих задач по трансформации и загрузке данных.

**Цель (измеримая):** Успешное выполнение скрипта, который применяет схему к Neo4j, скачивает данные и создает непустой файл `data/raw_recipes.jsonl` в качестве локального кэша.

**Инструменты и почему:**
- **Python (`requests`, `pandas`):** Для извлечения и базовой обработки данных из внешних источников (API/CSV).
- **`@dataclass`:** Для определения строгих моделей данных `Recipe`, `Ingredient` в нашем доменном слое.
- **Neo4j Driver:** Для применения схемы (создания индексов и ограничений).
- **Cypher:** Язык запросов для создания схемы.

**Стратегический план работ:**
1.  **Создание схемы в Neo4j:** Написать и выполнить скрипт в `scripts/`, который подключается к БД и создает ограничения уникальности (uniqueness constraints) для `Recipe(id)` и `Ingredient(normalizedName)`. Это нужно сделать **до** загрузки данных.
2.  **Поиск и выбор источника данных:** Найти и утвердить общедоступный датасет с рецептами (в формате CSV или JSON).
3.  **Определение доменных моделей:** Создать файлы и определить датаклассы `Recipe` и `Ingredient` в папке `src/neochef/domain/`.
4.  **Реализация "Экстрактора":** Создать класс-адаптер в `src/neochef/adapters/`, отвечающий за чтение данных из выбранного источника и их преобразование в наши доменные модели.
5.  **Реализация локального кэша:** Добавить в "Экстрактор" логику для сохранения списка объектов `Recipe` в файл `data/raw_recipes.jsonl`.
6.  **Подготовка к загрузке:** В финале задачи мы должны иметь кэш-файл, который в следующих задачах мы будем загружать в Neo4j двумя способами: "нативным" (`UNWIND`) и с помощью `APOC`, чтобы сравнить их производительность.

**Метрики успеха:**
- Скрипт создания схемы выполняется без ошибок.
- Скрипт-экстрактор успешно запускается и создает файл `data/raw_recipes.jsonl`.
- Файл `data/raw_recipes.jsonl` содержит валидные данные (например, более 1000 записей).